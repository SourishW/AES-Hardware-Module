#include "keyexpansion.h"
#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>

int main() {
    uint8_t key1[16] = {0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c};
    uint8_t key2[24] = {0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c, 0xa0, 0xfa, 0xfe, 0x17, 0x88, 0x54, 0x2c, 0xb1};
    uint8_t key3[32] = {0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c, 0xa0, 0xfa, 0xfe, 0x17, 0x88, 0x54, 0x2c, 0xb1, 0x23, 0xa3, 0x39, 0x39, 0x2a, 0x6c, 0x76, 0x05};
    uint8_t* keys[] = {key1, key2, key3};
    uint8_t key_lengths[] = {16, 24, 32};
    for (int i = 0; i < 3; i++) {
        uint8_t expandedkey[240];
        int byte_count = generateRoundKeys(keys[i], expandedkey, key_lengths[i]);
        printf("Byte count: %d\n", byte_count);
        printf("Expanded key: \n");
        for (int i = 0; i < byte_count; i++) {
            if (i % 4 == 0) printf("%d. ", i/4 + 1);
            printf("%02x ", expandedkey[i]);
            if (i % 4 == 3) printf("\n");
        }
        printf("\n");
    }
    
}